"use client"

import React, { useEffect, useState } from "react";
import { motion } from "framer-motion";
import { useInView } from "react-intersection-observer";

// SentryAgent Landing — Single-file preview (fixed)
// - Removed external `lucide-react` imports to avoid CDN/icon path build errors.
// - Inline SVG icons replaced problematic external icon fetches.
// - Keep Tailwind, Framer Motion, and react-intersection-observer as the intended stack.

const BRAND = {
  purpleFrom: "#7C3AED",
  purpleTo: "#9333EA",
  indigo: "#4F46E5",
  cyan: "#06B6D4",
  neon: "#00FF85", // neon green brand accent for SentryAgent
  darkA: "#0F0F1E",
  darkB: "#1A1A2E",
  glass: "rgba(255,255,255,0.06)",
};

/* Inline SVG icon components (replace lucide-react to avoid remote fetch issues) */
function IconMenu({ size = 18 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M3 6h18M3 12h18M3 18h18" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconSun({ size = 18 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M12 3v2M12 19v2M4.2 4.2l1.4 1.4M18.4 18.4l1.4 1.4M1 12h2M21 12h2M4.2 19.8l1.4-1.4M18.4 5.6l1.4-1.4" stroke="currentColor" strokeWidth="1.6" strokeLinecap="round" strokeLinejoin="round"/>
      <circle cx="12" cy="12" r="3.2" stroke="currentColor" strokeWidth="1.6" />
    </svg>
  );
}
function IconMoon({ size = 18 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M21 12.8A9 9 0 1111.2 3 7 7 0 0021 12.8z" stroke="currentColor" strokeWidth="1.6" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconCheck({ size = 16 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M20 6L9 17l-5-5" stroke="currentColor" strokeWidth="1.8" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconZap({ size = 16 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M13 2L3 14h7l-1 8 10-12h-7l1-8z" stroke="currentColor" strokeWidth="1.6" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconShield({ size = 16 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M12 3l7 3v5c0 5-3.5 9.8-7 11-3.5-1.2-7-6-7-11V6l7-3z" stroke="currentColor" strokeWidth="1.6" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconTerminal({ size = 16 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M4 6h16M4 18h16M7 9l5 3-5 3" stroke="currentColor" strokeWidth="1.6" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconArrowRight({ size = 16 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="none" aria-hidden>
      <path d="M5 12h14M13 5l7 7-7 7" stroke="currentColor" strokeWidth="1.6" strokeLinecap="round" strokeLinejoin="round" />
    </svg>
  );
}
function IconGithub({ size = 16 }: { size?: number }) {
  return (
    <svg width={size} height={size} viewBox="0 0 24 24" fill="currentColor" aria-hidden>
      <path d="M12 .5a12 12 0 00-3.8 23.4c.6.1.8-.3.8-.6v-2.1c-3.3.7-4-1.6-4-1.6-.5-1.3-1.2-1.6-1.2-1.6-1-.7.1-.7.1-.7 1.1.1 1.6 1.1 1.6 1.1 1 .1 1.6-.7 1.6-.7.9-1.5 2.5-1.1 3.1-.8.1-.6.4-1 .7-1.2-2.6-.3-5.3-1.3-5.3-5.9 0-1.3.5-2.4 1.2-3.2-.2-.3-.5-1.6.1-3.4 0 0 1-.3 3.4 1.2a11.6 11.6 0 016.2 0c2.4-1.5 3.4-1.2 3.4-1.2.6 1.8.3 3.1.1 3.4.7.8 1.2 1.9 1.2 3.2 0 4.6-2.7 5.6-5.3 5.9.4.4.8 1 .8 2v3c0 .3.2.7.8.6A12 12 0 0012 .5z" />
    </svg>
  );
}

const features = [
  {
    title: "Multi-Agent Analysis",
    desc: "Parallel expert agents specializing in on-chain exploits, formal verification hints, and gas misuse.",
    Icon: IconShield,
  },
  {
    title: "Symbolic & Fuzzing",
    desc: "Combine symbolic analysis with domain-specific fuzzers to find edge-case failures.",
    Icon: IconTerminal,
  },
  {
    title: "Auto-Fix Suggestions",
    desc: "Contextual patch suggestions with risk scoring and tests you can run locally.",
    Icon: IconZap,
  },
  {
    title: "CI/CD Integration",
    desc: "Gate PRs with scan artifacts, annotations, and developer-friendly reports.",
    Icon: IconGithub,
  },
];

function usePrefersDark() {
  const [isDark, setIsDark] = useState(true);
  useEffect(() => {
    const root = document.documentElement;
    if (isDark) root.classList.add("dark");
    else root.classList.remove("dark");
  }, [isDark]);
  return [isDark, setIsDark] as const;
}

function GlassCard({ children, className = "" }: any) {
  return (
    <div
      className={`backdrop-blur-md bg-[rgba(255,255,255,0.03)] dark:bg-[rgba(255,255,255,0.03)] border border-white/6 rounded-2xl p-6 ${className}`}
    >
      {children}
    </div>
  );
}

function AnimatedNumber({ target, duration = 1200 }: { target: number; duration?: number }) {
  const [display, setDisplay] = useState(0);
  useEffect(() => {
    let start = Date.now();
    const id = setInterval(() => {
      const now = Date.now();
      const t = Math.min(1, (now - start) / duration);
      setDisplay(Math.floor(t * target));
      if (t === 1) clearInterval(id);
    }, 16);
    return () => clearInterval(id);
  }, [target, duration]);
  return <>{display.toLocaleString()}</>;
}

function Stat({ label, value }: { label: string; value: number }) {
  const [ref, inView] = useInView({ triggerOnce: true, threshold: 0.4 });
  return (
    <div ref={ref} className="text-center">
      <div className="text-3xl md:text-4xl font-extrabold">
        {inView ? <AnimatedNumber target={value} duration={1400} /> : 0}
      </div>
      <div className="text-sm text-zinc-400 mt-2">{label}</div>
    </div>
  );
}

export default function SentryAgentLanding() {
  const [isDark, setIsDark] = usePrefersDark();
  const [heroRef, heroInView] = useInView({ threshold: 0.6 });
  const navSolid = !heroInView;

  return (
    <div
      className="min-h-screen font-sans"
      style={{
        background: `linear-gradient(180deg, ${BRAND.darkA} 0%, ${BRAND.darkB} 100%)`,
        color: "#E6E6F0",
      }}
    >
      {/* Floating transparent navbar */}
      <header
        className={`fixed top-4 left-0 right-0 mx-auto z-50 max-w-7xl px-6 transition-all duration-450 ${
          navSolid
            ? "bg-[rgba(15,15,30,0.7)] backdrop-blur-md border border-white/6 shadow-lg"
            : "bg-transparent"
        } rounded-2xl`}
      >
        <nav className="flex items-center justify-between py-3">
          <div className="flex items-center gap-4">
            <div className="flex items-center gap-3 cursor-pointer" style={{ color: BRAND.neon }}>
              <div className="w-9 h-9 rounded-full bg-gradient-to-br from-[#072A20] to-[#00321A] flex items-center justify-center ring-1 ring-white/6">
                <svg width="18" height="18" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                  <circle cx="12" cy="12" r="8" stroke={BRAND.neon} strokeWidth="1.6" />
                  <path d="M8 12c1.5-3 6-3 7 0" stroke={BRAND.neon} strokeWidth="1.4" strokeLinecap="round" />
                </svg>
              </div>
              <span className="font-semibold tracking-tight">SentryAgent</span>
            </div>
            <div className="hidden md:flex items-center gap-6 ml-6 text-sm text-zinc-300">
              <a className="hover:text-white transition">Product</a>
              <a className="hover:text-white transition">Docs</a>
              <a className="hover:text-white transition">Integrations</a>
              <a className="hover:text-white transition">Pricing</a>
            </div>
          </div>

          <div className="flex items-center gap-3">
            <button aria-label="theme" onClick={() => setIsDark((s) => !s)} className="p-2 rounded-lg hover:scale-105 transition-transform text-zinc-200">
              {isDark ? <IconSun /> : <IconMoon />}
            </button>
            <a className="hidden md:inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-[rgba(255,255,255,0.02)] border border-white/6 text-sm">
              <IconGithub /> <span className="ml-2">GitHub</span>
            </a>
            <button className="px-4 py-2 rounded-lg text-sm bg-gradient-to-r from-[rgba(255,255,255,0.03)] to-[rgba(255,255,255,0.01)] border border-white/6 hover:scale-105 transition">
              Sign up
            </button>
            <div className="md:hidden p-2 rounded-lg bg-[rgba(255,255,255,0.02)]">
              <IconMenu />
            </div>
          </div>
        </nav>
      </header>

      {/* HERO */}
      <main className="pt-28">
        <section ref={heroRef} className="relative overflow-hidden">
          {/* Animated background blobs */}
          <motion.div className="absolute inset-0 -z-10" initial={{ opacity: 0 }} animate={{ opacity: 1 }} transition={{ duration: 0.8 }} aria-hidden>
            <svg className="absolute top-10 left-[-10%] w-[40vw] opacity-30" viewBox="0 0 600 600" fill="none">
              <defs>
                <linearGradient id="g1" x1="0" x2="1">
                  <stop offset="0%" stopColor={BRAND.purpleFrom} stopOpacity="0.7" />
                  <stop offset="100%" stopColor={BRAND.indigo} stopOpacity="0.7" />
                </linearGradient>
              </defs>
              <path d="M421.2,68.4C458,106,457,190.6,430.3,238.1C403.7,285.7,342.5,295.1,287.4,311.6C232.3,328.1,183.3,351.7,141.1,334.6C98.9,317.4,63.6,259.6,68.8,206.7C74,153.9,119.8,106.9,173.8,78.2C227.8,49.5,384.5,31.1,421.2,68.4Z" fill="url(#g1)" />
            </svg>

            <motion.div className="absolute right-[-8%] top-32 w-[28vw] opacity-25 pointer-events-none" animate={{ rotate: [0, 8, -6, 0] }} transition={{ duration: 12, repeat: Infinity, ease: "easeInOut" }}>
              <div className="w-full h-72 rounded-3xl" style={{ background: `linear-gradient(135deg, ${BRAND.cyan}, ${BRAND.purpleTo})`, filter: "blur(40px)" }} />
            </motion.div>

            <motion.div className="absolute left-1/2 transform -translate-x-1/2 bottom-[-10%] w-[80vw] h-40 rounded-full opacity-10" animate={{ scale: [1, 1.05, 1] }} transition={{ duration: 8, repeat: Infinity }} style={{ background: `radial-gradient(circle at 20% 20%, ${BRAND.neon}, transparent 20%), radial-gradient(circle at 80% 80%, ${BRAND.purpleFrom}, transparent 25%)` }} />
          </motion.div>

          <div className="max-w-7xl mx-auto px-6 py-28">
            <div className="grid grid-cols-1 md:grid-cols-2 gap-10 items-center">
              <div>
                <div className="inline-flex items-center gap-3 mb-6">
                  <span className="px-3 py-1 rounded-full text-xs font-medium" style={{ background: `linear-gradient(90deg, ${BRAND.neon}, ${BRAND.cyan})`, color: "#05140d" }}>
                    Launching 2025 • Early access
                  </span>
                  <span className="text-sm text-zinc-400">Secure your smart contracts before they ship</span>
                </div>

                <h1 className="text-4xl md:text-6xl font-extrabold leading-tight tracking-tight text-white">
                  SentryAgent — <span style={{ color: BRAND.neon }}>Agentic</span> smart contract security.
                </h1>

                <p className="mt-6 text-zinc-300 max-w-2xl">
                  Multi-agent specialized scanner that blends symbolic analysis, fuzzing, and vulnerability patch suggestions. Designed for modern DevSecOps pipelines and Web3 teams.
                </p>

                <div className="flex gap-4 mt-8 items-center">
                  <a className="inline-flex items-center gap-3 px-5 py-3 rounded-xl font-medium shadow-lg" style={{ background: `linear-gradient(90deg, ${BRAND.neon} 0%, ${BRAND.cyan} 100%)`, color: "#03160f" }}>
                    Get Early Access <span className="ml-2"><IconArrowRight /></span>
                  </a>
                  <a className="inline-flex items-center gap-3 px-4 py-3 rounded-xl border border-white/6 text-sm hover:scale-105 transition">Live demo</a>
                </div>

                <div className="mt-8 flex flex-wrap gap-4 text-sm text-zinc-400">
                  <div className="flex items-center gap-2"><IconCheck /> Real-time vulnerability scoring</div>
                  <div className="flex items-center gap-2"><IconShield /> CI-friendly annotations</div>
                  <div className="flex items-center gap-2"><IconZap /> Auto-fix proposals</div>
                </div>
              </div>

              {/* Live demo preview card on the right */}
              <div>
                <GlassCard>
                  <div className="flex items-start gap-4">
                    <div className="w-3 h-3 rounded-full bg-[#ff5f56]" />
                    <div className="w-3 h-3 rounded-full bg-[#ffbd2e]" />
                    <div className="w-3 h-3 rounded-full bg-[#27c93f]" />
                  </div>

                  <div className="mt-4 bg-gradient-to-b from-[rgba(0,0,0,0.12)] to-transparent p-4 rounded-xl">
                    <div className="flex items-center justify-between mb-3">
                      <div className="text-xs text-zinc-400">sentryagent scan • v0.9</div>
                      <div className="text-xs text-zinc-400">connected</div>
                    </div>

                    <pre className="rounded-lg p-4 text-sm text-[rgba(255,255,255,0.9)] bg-[linear-gradient(180deg,rgba(0,0,0,0.2),rgba(0,0,0,0.08))] overflow-auto">
{`> scanning contract: PaymentSplitter.sol
> running agents: Symbolic, Fuzzer, GasAudit

[✓] Reentrancy - HIGH (agent: Symbolic)
  -> trace: transfer -> call -> state change
  -> suggestion: apply reentrancy guard

[!] Gas spike - MEDIUM (agent: GasAudit)
  -> suggestion: optimize loop

[✓] Access control - LOW

Summary: 2 warnings, 1 critical
`}
                    </pre>

                    <div className="mt-4 flex gap-3">
                      <button className="px-4 py-2 rounded-md text-sm" style={{ border: "1px solid rgba(255,255,255,0.04)" }}>
                        Export report
                      </button>
                      <button className="px-4 py-2 rounded-md text-sm" style={{ background: `linear-gradient(90deg, ${BRAND.purpleFrom}, ${BRAND.purpleTo})` }}>
                        Open in workspace
                      </button>
                    </div>
                  </div>
                </GlassCard>
              </div>
            </div>

            {/* Features grid */}
            <div className="mt-20">
              <h3 className="text-xl font-semibold mb-6">What SentryAgent brings</h3>

              <div className="grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-4 gap-6">
                {features.map((f) => {
                  const Icon = f.Icon;
                  return (
                    <motion.div key={f.title} whileHover={{ scale: 1.03 }} className="relative">
                      <div className="group bg-[rgba(255,255,255,0.02)] border border-white/6 rounded-2xl p-6 hover:shadow-[0_6px_30px_rgba(124,58,237,0.12)] transition">
                        <div className="flex items-center gap-4">
                          <div className="w-12 h-12 rounded-lg flex items-center justify-center" style={{ background: `linear-gradient(135deg, ${BRAND.purpleFrom}, ${BRAND.indigo})` }}>
                            <Icon />
                          </div>
                          <div>
                            <div className="font-semibold">{f.title}</div>
                            <div className="text-sm text-zinc-400 mt-1">{f.desc}</div>
                          </div>
                        </div>

                        <div className="mt-4 flex items-center gap-2 text-xs text-zinc-400">
                          <span className="inline-flex items-center gap-2 px-2 py-1 rounded-full text-[10px] border border-white/5">Agentic</span>
                          <span className="inline-flex items-center gap-2 px-2 py-1 rounded-full text-[10px] border border-white/5">CI-ready</span>
                        </div>

                        <div className="absolute right-4 top-4 opacity-0 group-hover:opacity-100 transition">
                          <div className="w-2 h-2 rounded-full" style={{ background: BRAND.neon }} />
                        </div>
                      </div>
                    </motion.div>
                  );
                })}
              </div>
            </div>

            {/* How it works */}
            <div className="mt-24 grid grid-cols-1 md:grid-cols-3 gap-8 items-start">
              <div>
                <h3 className="text-2xl font-semibold">How it works</h3>
                <p className="mt-4 text-zinc-400">A simple pipeline combining multiple expert agents and actionable outputs developers can run locally.</p>
              </div>

              <div className="md:col-span-2">
                <ol className="space-y-6">
                  {[
                    { t: "1. Ingest & Index", d: "Contract AST + bytecode + sources are indexed into a unified vector store for context-aware agents." },
                    { t: "2. Agent orchestration", d: "Parallel agents run targeted checks: symbolic, fuzzing, CI rules." },
                    { t: "3. Report & Fix", d: "Human-readable report, vulnerability trace, and suggested patches for maintainers." },
                  ].map((s, i) => (
                    <motion.li key={s.t} className="flex items-start gap-4 bg-[rgba(255,255,255,0.02)] border border-white/5 rounded-lg p-4" whileInView={{ x: 0, opacity: 1 }} initial={{ x: -20, opacity: 0 }} viewport={{ once: true, amount: 0.4 }}>
                      <div className="w-10 h-10 rounded-lg flex items-center justify-center" style={{ background: `linear-gradient(90deg, ${BRAND.indigo}, ${BRAND.purpleTo})` }}>
                        <span className="font-semibold">{i + 1}</span>
                      </div>
                      <div>
                        <div className="font-semibold">{s.t}</div>
                        <div className="text-sm text-zinc-400">{s.d}</div>
                      </div>
                    </motion.li>
                  ))}
                </ol>
              </div>
            </div>

            {/* Metrics & Testimonials */}
            <div className="mt-24 grid grid-cols-1 lg:grid-cols-3 gap-8">
              <div className="lg:col-span-1">
                <GlassCard>
                  <div className="grid grid-cols-3 gap-4">
                    <Stat label="Contracts scanned" value={23412} />
                    <Stat label="Critical finds" value={412} />
                    <Stat label="Avg time / scan (s)" value={32} />
                  </div>
                </GlassCard>

                <div className="mt-6">
                  <h4 className="font-semibold">Trusted by</h4>
                  <div className="mt-3 flex items-center gap-3 text-zinc-300">
                    <div className="w-10 h-10 rounded-md bg-white/5 flex items-center justify-center">A</div>
                    <div className="w-10 h-10 rounded-md bg-white/5 flex items-center justify-center">B</div>
                    <div className="w-10 h-10 rounded-md bg-white/5 flex items-center justify-center">C</div>
                  </div>
                </div>
              </div>

              <div className="lg:col-span-2">
                <h3 className="text-xl font-semibold mb-4">What users say</h3>
                <div className="overflow-x-auto no-scrollbar flex gap-4 py-2">
                  {[
                    { quote: "Found a gas exploit we missed during audits.", who: "Alice — Protocol Dev" },
                    { quote: "CI integration caught a vulnerability on PR.", who: "Ravi — Security Lead" },
                    { quote: "Actionable patches saved us weeks of work.", who: "María — Auditor" },
                  ].map((t) => (
                    <div key={t.who} className="min-w-[260px] bg-[rgba(255,255,255,0.02)] border border-white/5 rounded-2xl p-4">
                      <div className="text-zinc-200">“{t.quote}”</div>
                      <div className="mt-3 text-sm text-zinc-400">{t.who}</div>
                    </div>
                  ))}
                </div>
              </div>
            </div>

            {/* CTA */}
            <div className="mt-20">
              <div className="rounded-2xl p-8 flex flex-col md:flex-row items-center justify-between" style={{ background: `linear-gradient(90deg, rgba(124,58,237,0.12), rgba(79,70,229,0.06))`, border: "1px solid rgba(255,255,255,0.04)" }}>
                <div>
                  <h3 className="text-2xl font-bold">Start securing your contracts</h3>
                  <p className="text-zinc-300 mt-2">Join the waitlist and get early access to the SentryAgent CLI, GitHub App, and cloud features.</p>
                </div>
                <div className="mt-4 md:mt-0 flex gap-4">
                  <button className="px-6 py-3 rounded-xl font-semibold" style={{ background: `linear-gradient(90deg, ${BRAND.neon}, ${BRAND.cyan})`, color: "#03160f" }}>
                    Join waitlist
                  </button>
                  <button className="px-6 py-3 rounded-xl border border-white/6">Contact sales</button>
                </div>
              </div>
            </div>

            {/* Footer */}
            <footer className="mt-20 py-12 text-sm text-zinc-400">
              <div className="max-w-7xl mx-auto px-6 flex flex-col md:flex-row items-center justify-between gap-4">
                <div className="flex items-center gap-3">
                  <div className="w-9 h-9 rounded-full flex items-center justify-center" style={{ background: `linear-gradient(90deg, ${BRAND.neon}, ${BRAND.cyan})` }}>
                    <svg width="14" height="14" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                      <circle cx="12" cy="12" r="7" fill="#000" />
                      <path d="M8 12c1.5-3 6-3 7 0" stroke="#00FF85" strokeWidth="1.2" strokeLinecap="round" />
                    </svg>
                  </div>
                  <div>
                    <div className="font-semibold text-white">SentryAgent</div>
                    <div className="text-xs text-zinc-400">Multi-agent smart contract security</div>
                  </div>
                </div>

                <div className="flex items-center gap-4">
                  <a>Docs</a>
                  <a>GitHub</a>
                  <a>Privacy</a>
                </div>
              </div>
            </footer>
          </div>
        </section>
      </main>

      {/* small util styles for this preview */}
      <style jsx>{`
        :global(html) { font-family: Inter, ui-sans-serif, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
      `}</style>
    </div>
  );
}
